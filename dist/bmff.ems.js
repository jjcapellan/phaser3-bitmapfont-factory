var t=0;function e(e){return"__private_"+t+++"_"+e}function r(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var n,i,o,a,s=[" A"," T"," Y","11","A ","AT","AV","AW","AY","Av","Aw","Ay","F,","F.","FA","L ","LT","LV","LW","LY","Ly","P ","P,","P.","PA","RT","RV","RW","RY","T ","T,","T-","T.","T:","T;","TA","TO","Ta","Tc","Te","Ti","To","Tr","Ts","Tu","Tw","Ty","V,","V-","V.","V:","V;","VA","Va","Ve","Vi","Vo","Vr","Vu","Vy","W,","W-","W.","W:","W;","WA","Wa","We","Wi","Wo","Wr","Wu","Wy","Y ","Y,","Y-","Y.","Y:","Y;","YA","Ya","Ye","Yi","Yo","Yp","Yq","Yu","Yv","ff","r,","r.","v,","v.","w,","w.","y,","y."],h=["Arial","Calibri","Helvetica","Roboto","Trebuchet MS","Verdana"],u=["Garamond","Georgia","serif","Times","Times New Roman"],c=["Consolas","Courier","Courier New","monospace"],l="",f=(n=function(t){for(var e=["i","webkitI","msI","mozI","oI"],r=0;r<e.length;r++){var n=e[r]+"mageSmoothingEnabled";if(n in t)return n}return null},[]),v=!1,d=(a=function(){var t=0;return f.forEach(function(e){e.parent&&t++}),t},{create2D:function(t,e,r){return i(t,e,r,1)},create:i=function(t,e,r,i,a){var s;void 0===e&&(e=1),void 0===r&&(r=1),void 0===i&&(i=1),void 0===a&&(a=!1);var h,u=o(i);return null===u?(u={parent:t,canvas:document.createElement("canvas"),type:i},1===i&&f.push(u),s=u.canvas):(u.parent=t,s=u.canvas),a&&(u.parent=s),s.width=e,s.height=r,v&&1===i&&(h=s.getContext("2d"),""===l&&(l=n(h)),l&&(h[l]=!1)),s},createWebGL:function(t,e,r){return i(t,e,r,2)},disableSmoothing:function(){v=!0},enableSmoothing:function(){v=!1},first:o=function(t){if(void 0===t&&(t=1),2===t)return null;for(var e=0;e<f.length;e++){var r=f[e];if(!r.parent&&r.type===t)return r}return null},free:function(){return f.length-a()},pool:f,remove:function(t){var e=t instanceof HTMLCanvasElement;f.forEach(function(r){(e&&r.canvas===t||!e&&r.parent===t)&&(r.parent=null,r.canvas.width=1,r.canvas.height=1)})},total:a});function g(t,e,r){var n=r?t[e]:Object.getOwnPropertyDescriptor(t,e);return!r&&n.value&&"object"==typeof n.value&&(n=n.value),!(!n||!function(t){return!!t.get&&"function"==typeof t.get||!!t.set&&"function"==typeof t.set}(n))&&(void 0===n.enumerable&&(n.enumerable=!0),void 0===n.configurable&&(n.configurable=!0),n)}function p(t,e){var r=Object.getOwnPropertyDescriptor(t,e);return!!r&&(r.value&&"object"==typeof r.value&&(r=r.value),!1===r.configurable)}function m(t,e,r,n){for(var i in e)if(e.hasOwnProperty(i)){var o=g(e,i,r);if(!1!==o){if(p((n||t).prototype,i)){if(b.ignoreFinals)continue;throw new Error("cannot override final property '"+i+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(t.prototype,i,o)}else t.prototype[i]=e[i]}}function y(t,e){if(e){Array.isArray(e)||(e=[e]);for(var r=0;r<e.length;r++)m(t,e[r].prototype||e[r])}}function b(t){var e,r;if(t||(t={}),t.initialize){if("function"!=typeof t.initialize)throw new Error("initialize must be a function");e=t.initialize,delete t.initialize}else if(t.Extends){var n=t.Extends;e=function(){n.apply(this,arguments)}}else e=function(){};t.Extends?(e.prototype=Object.create(t.Extends.prototype),e.prototype.constructor=e,r=t.Extends,delete t.Extends):e.prototype.constructor=e;var i=null;return t.Mixins&&(i=t.Mixins,delete t.Mixins),y(e,i),m(e,t,!0,r),e}b.extend=m,b.mixin=y,b.ignoreFinals=!1;var w=function(t,e,r){return t<<16|e<<8|r};function P(t,e,r,n){var i=(t+6*e)%6,o=Math.min(i,4-i,1);return Math.round(255*(n-n*r*Math.max(0,o)))}var x=function(t,e,r,n){void 0===e&&(e=1),void 0===r&&(r=1);var i=P(5,t,e,r),o=P(3,t,e,r),a=P(1,t,e,r);return n?n.setTo?n.setTo(i,o,a,n.alpha,!1):(n.r=i,n.g=o,n.b=a,n.color=w(i,o,a),n):{r:i,g:o,b:a,color:w(i,o,a)}},M=function(t,e,r,n){void 0===n&&(n={h:0,s:0,v:0}),t/=255,e/=255,r/=255;var i=Math.min(t,e,r),o=Math.max(t,e,r),a=o-i,s=0,h=0===o?0:a/o,u=o;return o!==i&&(o===t?s=(e-r)/a+(e<r?6:0):o===e?s=(r-t)/a+2:o===r&&(s=(t-e)/a+4),s/=6),n.hasOwnProperty("_h")?(n._h=s,n._s=h,n._v=u):(n.h=s,n.s=h,n.v=u),n},T=new b({initialize:function(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(t,e,r,n)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(t,e,r,n,i){return void 0===n&&(n=255),void 0===i&&(i=!0),this._locked=!0,this.red=t,this.green=e,this.blue=r,this.alpha=n,this._locked=!1,this.update(i)},setGLTo:function(t,e,r,n){return void 0===n&&(n=1),this._locked=!0,this.redGL=t,this.greenGL=e,this.blueGL=r,this.alphaGL=n,this._locked=!1,this.update(!0)},setFromRGB:function(t){return this._locked=!0,this.red=t.r,this.green=t.g,this.blue=t.b,t.hasOwnProperty("a")&&(this.alpha=t.a),this._locked=!1,this.update(!0)},setFromHSV:function(t,e,r){return x(t,e,r,this)},update:function(t){if(void 0===t&&(t=!1),this._locked)return this;var e=this.r,r=this.g,n=this.b,i=this.a;return this._color=w(e,r,n),this._color32=i<<24|e<<16|r<<8|n,this._rgba="rgba("+e+","+r+","+n+","+i/255+")",t&&M(e,r,n,this),this},updateHSV:function(){return M(this.r,this.g,this.b,this),this},clone:function(){return new T(this.r,this.g,this.b,this.a)},gray:function(t){return this.setTo(t,t,t)},random:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var r=Math.floor(t+Math.random()*(e-t)),n=Math.floor(t+Math.random()*(e-t)),i=Math.floor(t+Math.random()*(e-t));return this.setTo(r,n,i)},randomGray:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var r=Math.floor(t+Math.random()*(e-t));return this.setTo(r,r,r)},saturate:function(t){return this.s+=t/100,this},desaturate:function(t){return this.s-=t/100,this},lighten:function(t){return this.v+=t/100,this},darken:function(t){return this.v-=t/100,this},brighten:function(t){var e=this.r,r=this.g,n=this.b;return e=Math.max(0,Math.min(255,e-Math.round(-t/100*255))),r=Math.max(0,Math.min(255,r-Math.round(-t/100*255))),n=Math.max(0,Math.min(255,n-Math.round(-t/100*255))),this.setTo(e,r,n)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(t){this.gl[0]=Math.min(Math.abs(t),1),this.r=Math.floor(255*this.gl[0]),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(t){this.gl[1]=Math.min(Math.abs(t),1),this.g=Math.floor(255*this.gl[1]),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(t){this.gl[2]=Math.min(Math.abs(t),1),this.b=Math.floor(255*this.gl[2]),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(t){this.gl[3]=Math.min(Math.abs(t),1),this.a=Math.floor(255*this.gl[3]),this.update()}},red:{get:function(){return this.r},set:function(t){t=Math.floor(Math.abs(t)),this.r=Math.min(t,255),this.gl[0]=t/255,this.update(!0)}},green:{get:function(){return this.g},set:function(t){t=Math.floor(Math.abs(t)),this.g=Math.min(t,255),this.gl[1]=t/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(t){t=Math.floor(Math.abs(t)),this.b=Math.min(t,255),this.gl[2]=t/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(t){t=Math.floor(Math.abs(t)),this.a=Math.min(t,255),this.gl[3]=t/255,this.update()}},h:{get:function(){return this._h},set:function(t){this._h=t,x(t,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(t){this._s=t,x(this._h,t,this._v,this)}},v:{get:function(){return this._v},set:function(t){this._v=t,x(this._h,this._s,t,this)}}}),k=T,O=function(t,e,r){var n=typeof t;return t&&"number"!==n&&"string"!==n&&t.hasOwnProperty(e)&&void 0!==t[e]?t[e]:r};function _(t,e){return parseInt(t.getAttribute(e),10)}var j=function(t,e,r,n,i){void 0===r&&(r=0),void 0===n&&(n=0);var o=e.cutX,a=e.cutY,s=e.source.width,h=e.source.height,u=e.sourceIndex,c={},l=t.getElementsByTagName("info")[0],f=t.getElementsByTagName("common")[0];c.font=l.getAttribute("face"),c.size=_(l,"size"),c.lineHeight=_(f,"lineHeight")+n,c.chars={};var v=t.getElementsByTagName("char"),d=void 0!==e&&e.trimmed;if(d)var g=e.height,p=e.width;for(var m=0;m<v.length;m++){var y=v[m],b=_(y,"id"),w=String.fromCharCode(b),P=_(y,"x"),x=_(y,"y"),M=_(y,"width"),T=_(y,"height");d&&(P<p&&(p=P),x<g&&(g=x)),d&&0!==g&&0!==p&&(P-=e.x,x-=e.y);var k=(o+P)/s,O=(a+x)/h,j=(o+P+M)/s,A=(a+x+T)/h;if(c.chars[b]={x:P,y:x,width:M,height:T,centerX:Math.floor(M/2),centerY:Math.floor(T/2),xOffset:_(y,"xoffset"),yOffset:_(y,"yoffset"),xAdvance:_(y,"xadvance")+r,data:{},kerning:{},u0:k,v0:O,u1:j,v1:A},i&&0!==M&&0!==T){var L=i.add(w,u,P,x,M,T);L&&L.setUVs(M,T,k,O,j,A)}}var W=t.getElementsByTagName("kerning");for(m=0;m<W.length;m++){var F=W[m],V=_(F,"first"),Y=_(F,"second"),G=_(F,"amount");c.chars[Y].kerning[V]=G}return c};function A(t,e,r){if(!t.s){if(r instanceof W){if(!r.s)return void(r.o=A.bind(null,t,e));1&e&&(e=r.s),r=r.v}if(r&&r.then)return void r.then(A.bind(null,t,e),A.bind(null,t,2));t.s=e,t.v=r;var n=t.o;n&&n(t)}}var L=/*#__PURE__*/e("currentPendingSteps"),W=/*#__PURE__*/function(){function t(){}return t.prototype.then=function(e,r){var n=new t,i=this.s;if(i){var o=1&i?e:r;if(o){try{A(n,1,o(this.v))}catch(t){A(n,2,t)}return n}return this}return this.o=function(t){try{var i=t.v;1&t.s?A(n,1,e?e(i):i):r?A(n,1,r(i)):A(n,2,i)}catch(t){A(n,2,t)}},n},t}();function F(t,e,r){var n,i,o=-1;return function a(s){try{for(;++o<t.length&&(!r||!r());)if((s=e(o))&&s.then){if(!((h=s)instanceof W&&1&h.s))return void s.then(a,i||(i=A.bind(null,n=new W,2)));s=s.v}n?A(n,1,s):n=s}catch(t){A(n||(n=new W),2,t)}var h}(),n}var V=/*#__PURE__*/e("currentTexture"),Y=/*#__PURE__*/e("currentXMLs"),G=/*#__PURE__*/e("onComplete"),E=/*#__PURE__*/e("tasks"),S=/*#__PURE__*/e("textureWidth"),C=/*#__PURE__*/e("textureHeight"),z=/*#__PURE__*/e("totalGlyphs"),B=/*#__PURE__*/e("totalHeight"),I=/*#__PURE__*/e("totalProgress"),H=/*#__PURE__*/e("totalWidth"),R=/*#__PURE__*/e("calcBounds"),N=/*#__PURE__*/e("calcKernings"),D=/*#__PURE__*/e("finish"),K=/*#__PURE__*/e("getKerningPairs"),X=/*#__PURE__*/e("getTextureWidth"),U=/*#__PURE__*/e("getValidFont"),q=/*#__PURE__*/e("makeGlyphs"),J=/*#__PURE__*/e("makeTexture"),Q=/*#__PURE__*/e("makeXMLs"),Z=/*#__PURE__*/e("step"),$=/*#__PURE__*/function(){function t(t,e,n){var i=this,o=this,a=this,l=this,f=this;void 0===n&&(n={PoT:!1}),this.onProgress=void 0,this.PoT=!1,this.scene=void 0,this.defaultFonts={sansSerif:h,serif:u,monospace:c},Object.defineProperty(this,L,{writable:!0,value:0}),Object.defineProperty(this,V,{writable:!0,value:null}),Object.defineProperty(this,Y,{writable:!0,value:[]}),Object.defineProperty(this,G,{writable:!0,value:function(){}}),Object.defineProperty(this,E,{writable:!0,value:[]}),Object.defineProperty(this,S,{writable:!0,value:0}),Object.defineProperty(this,C,{writable:!0,value:0}),Object.defineProperty(this,z,{writable:!0,value:0}),Object.defineProperty(this,B,{writable:!0,value:0}),Object.defineProperty(this,I,{writable:!0,value:0}),Object.defineProperty(this,H,{writable:!0,value:0}),Object.defineProperty(this,R,{writable:!0,value:function(){var t,e=r(f,E)[E],n=0,i=0,o=0,a=0,s=0;t=r(f,X)[X](r(f,z)[z],r(f,B)[B],r(f,H)[H]);for(var h=0;h<e.length;h++){var u=e[h],c=u.glyphs,l=u.glyphsBounds,v=c[0].height;v>i&&(i=v);for(var d=0;d<c.length;d++){var g=c[d];(o+=g.width)>t&&(o=g.width,s+=i,i=v,a=0),l[d]={x:a,y:s,w:g.width,h:g.height},n=s+g.height,a+=g.width}}f.PoT&&(n=Phaser.Math.Pow2.GetNext(n)),r(f,S)[S]=t,r(f,C)[C]=n}}),Object.defineProperty(this,N,{writable:!0,value:function(){try{var t=r(i,E)[E];return Promise.resolve(F(t,function(e){var n=t[e];if(n.getKernings){for(var o=n.kernings,a=n.chars,s=n.glyphsBounds,h=r(i,K)[K](n),u=0;u<h.length;u++){var c=h[u].split(""),l=s[a.indexOf(c[0])].w+s[a.indexOf(c[1])].w,f=i.scene.make.text({text:h[u],style:n.style},!1),v=f.width-l;0!=v&&o.push({first:h[u].charCodeAt(0),second:h[u].charCodeAt(1),amount:v}),f.destroy()}var d=function(){if(i.onProgress){r(i,I)[I]+=1/r(i,E)[E].length*.5;var t=i;return Promise.resolve(new Promise(function(e){t.onProgress(r(t,I)[I]),t.scene.events.once("preupdate",e)})).then(function(){})}}();return d&&d.then?d.then(function(){}):void 0}}))}catch(t){return Promise.reject(t)}}}),Object.defineProperty(this,D,{writable:!0,value:function(){for(var t=r(f,V)[V],e=r(f,Y)[Y],n=r(f,E)[E][0].key,i=0;i<e.length;i++){var o=e[i],a=f.scene.textures.getFrame(n),s=j(o,a,0,0,t);f.scene.cache.bitmapFont.add(r(f,E)[E][i].key,{data:s,texture:n,frame:null})}r(f,V)[V]=null,r(f,Y)[Y]=[],r(f,E)[E]=[],r(f,G)[G]()}}),Object.defineProperty(this,K,{writable:!0,value:function(t){for(var e=[],r=0;r<s.length;r++){var n=s[r].split("");-1!=t.chars.indexOf(n[0])&&-1!=t.chars.indexOf(n[1])&&e.push(s[r])}return e}}),Object.defineProperty(this,X,{writable:!0,value:function(t,e,r){var n=Math.ceil(Math.sqrt(r/t*(e/t)*t));return f.PoT&&(n=Phaser.Math.Pow2.GetNext(n)),n}}),Object.defineProperty(this,U,{writable:!0,value:function(t){for(var e="",r=0;r<t.length;r++)if(f.check(t[r])){e=t[r];break}return e}}),Object.defineProperty(this,q,{writable:!0,value:function(){try{var t=r(o,E)[E];return Promise.resolve(F(t,function(e){var n=t[e],i=n.chars,a=i.length;r(o,z)[z]+=a;for(var s=0;s<a;s++){var h=o.scene.make.text({text:i[s],style:n.style},!1);n.glyphs.push(h),r(o,B)[B]+=h.height,r(o,H)[H]+=h.width}var u=function(){if(o.onProgress){r(o,I)[I]+=1/r(o,E)[E].length*.5;var t=o;return Promise.resolve(new Promise(function(e){t.onProgress(r(t,I)[I]),t.scene.events.once("preupdate",e)})).then(function(){})}}();if(u&&u.then)return u.then(function(){})}))}catch(t){return Promise.reject(t)}}}),Object.defineProperty(this,J,{writable:!0,value:function(){try{return Promise.resolve(function(t,e,r,n){try{var i=e[0].key,o=t.make.renderTexture({x:0,y:0,width:r,height:n},!1);o.setOrigin(0);for(var a=0;a<e.length;a++)for(var s=e[a],h=s.glyphs,u=s.glyphsBounds,c=0;c<h.length;c++){var l=u[c];o.draw(h[c],l.x,l.y)}return Promise.resolve(new Promise(function(e){!function(t,e,r){t.renderTarget?function(t,e,r){var n=e.currentFramebuffer,i=e.snapshotState;i.bufferHeight=t.height,i.bufferWidth=t.width,i.callback=r,i.encoderOptions=1,i.getPixel=!1,i.height=t.height,i.isFramebuffer=!0,i.type="image/png",i.width=t.width,i.x=0,i.y=0,e.setFramebuffer(t.renderTarget.framebuffer),Phaser.Renderer.Snapshot.WebGL(e.canvas,i),e.setFramebuffer(n),i.callback=null,i.isFramebuffer=!1}(t,e,r):function(t,e,r){var n=e.snapshotState;n.callback=r,n.encoder=1,n.getPixel=!1,n.height=t.height,n.type="image/png",n.width=t.width,n.x=0,n.y=0,function(t,e){var r=O(e,"callback"),n=O(e,"type","image/png"),i=O(e,"encoder",.92),o=Math.abs(Math.round(O(e,"x",0))),a=Math.abs(Math.round(O(e,"y",0))),s=O(e,"width",t.width),h=O(e,"height",t.height);if(O(e,"getPixel",!1)){var u=t.getContext("2d").getImageData(o,a,1,1).data;r.call(null,new k(u[0],u[1],u[2],u[3]/255))}else if(0!==o||0!==a||s!==t.width||h!==t.height){var c=d.createWebGL(this,s,h);c.getContext("2d").drawImage(t,o,a,s,h,0,0,s,h);var l=new Image;l.onerror=function(){r.call(null),d.remove(c)},l.onload=function(){r.call(null,l),d.remove(c)},l.src=c.toDataURL(n,i)}else{var f=new Image;f.onerror=function(){r.call(null)},f.onload=function(){r.call(null,f)},f.src=t.toDataURL(n,i)}}(t.canvas,n),n.callback=null}(t,e,r)}(o,t.renderer,function(r){t.textures.addImage(i,r);var n=t.textures.get(i);o.destroy(),e(n)})}))}catch(t){return Promise.reject(t)}}(a.scene,r(a,E)[E],r(a,S)[S],r(a,C)[C])).then(function(t){r(a,V)[V]=t,r(a,Z)[Z](null)})}catch(t){return Promise.reject(t)}}}),Object.defineProperty(this,Q,{writable:!0,value:function(){try{return r(l,Y)[Y]=function(t){for(var e=[],r=0;r<t.length;r++){for(var n=t[r],i=n.chars,o=n.chars.length,a=n.fontFamily,s=n.style.fontSize.replace("px",""),h=n.glyphsBounds,u='<?xml version="1.0"?><font><info face="'+a+'" size="'+s+'"></info><common lineHeight="'+s+'"></common><chars count="'+o+'">',c="",l=0;l<o;l++){var f=i[l].charCodeAt(0),v=h[l];c+='<char id="'+f+'" x="'+v.x+'" y="'+v.y+'" width="'+v.w+'" height="'+v.h+'" xoffset="0" yoffset="0" xadvance="'+v.w+'"/>'}c+="</chars>";var d="";if(n.getKernings){var g=n.kernings.length,p=n.kernings;d+='<kernings count="'+g+'">';for(var m=0;m<g;m++){var y=p[m];d+='<kerning first="'+y.first+'" second="'+y.second+'" amount="'+y.amount+'" />'}d+="</kernings>"}var b=u+c+d+"</font>",w=(new DOMParser).parseFromString(b,"application/xml");e.push(w)}return e}(r(l,E)[E]),r(l,Z)[Z](null),Promise.resolve()}catch(t){return Promise.reject(t)}}}),Object.defineProperty(this,Z,{writable:!0,value:function(t){r(f,L)[L]-=1,0==r(f,L)[L]&&r(f,D)[D]()}}),this.scene=t,this.PoT=n.PoT,this.onProgress=n.onProgress,r(this,G)[G]=e}var e=t.prototype;return e.check=function(t){return document.fonts.check("12px "+t)},e.exec=function(){try{var t=this;return r(t,z)[z]=0,r(t,B)[B]=0,r(t,H)[H]=0,Promise.resolve(r(t,q)[q]()).then(function(){return r(t,R)[R](),Promise.resolve(r(t,N)[N]()).then(function(){r(t,L)[L]=2,r(t,J)[J](),r(t,Q)[Q]()})})}catch(t){return Promise.reject(t)}},e.make=function(t,e,n,i,o){void 0===i&&(i={}),void 0===o&&(o=!0),null==i.fontSize&&(i.fontSize="32px");var a={chars:n,fontFamily:"string"==typeof e?e:r(this,U)[U](e),glyphs:[],glyphsBounds:[],getKernings:o,kernings:[],key:t,style:i};a.style.fontFamily=a.fontFamily,r(this,E)[E].push(a)},t}();export{$ as default};
